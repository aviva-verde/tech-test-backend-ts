<!DOCTYPE html>
<html>
<head>
    <title>Aviva Zero Tech Test</title>
    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <link rel="stylesheet" href="assets/style.css">
    <link rel="icon" type="image/png" href="assets/favicon.png" />
    <scripdata:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAzIiBoZWlnaHQ9IjE5IiB2aWV3Qm94PSIwIDAgMTAzIDE5IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTMuNTg3NCAwLjAwMTg4MDk4TDE1LjA5MTIgMTUuNDg2MUMxNi4yOTA0IDE1LjQxNTUgMTcuNTE0OSAxNS4zNzYgMTguNzY1NyAxNS4zNzMyTDE4Ljc3MDQgMC4wMDE4ODA5OEwxMy41ODc0IDBWMC4wMDE4ODA5OFoiIGZpbGw9IiM2NkIyNEMiLz4NCiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEzLjU4MDQgMEwxMi4wNTIxIDE1Ljc3OTVDMTMuMDQxNSAxNS42NzA0IDE0LjA1NDQgMTUuNTgzOSAxNS4wODcxIDE1LjUyMDlMMTMuNTgxNCAwSDEzLjU4MDRaIiBmaWxsPSIjRkZEOTAwIi8+DQogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wIDAuMDAxODgwOThMMC4wMDc1MjM5IDE4LjczODNDMy4xOTc2NiAxNy4zNDI2IDcuMzUxNzkgMTYuMzAyNCAxMi4wNTI0IDE1Ljc4MTRMMTMuNTgwNiAwLjAwMTg4MDk4VjBMMCAwLjAwMTg4MDk4WiIgZmlsbD0iIzAwNEZCNiIvPg0KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuMjc3NSAwVjAuMDAwOTQwNDg4VjAuNDgzNDExQzkwLjc2MzcgMC41ODU5MjQgOTEuODIzNiAwLjg4MTIzNyA5MS4zOTM4IDEuODM1ODNMODUuMzg4OCAxNS4yOTdIODguNTYyTDkwLjQ0MDIgMTEuMTAwNkg5Ny4wOTQxTDk4Ljc0IDE1LjI5N0gxMDIuOTE3TDk2Ljk1MTIgMEg5MC4yNzc1Wk05My45OTI0IDMuMTgzNTVMOTYuMzUxMSA5LjIwMDc5SDkxLjI5NDFMOTMuOTkyNCAzLjE4MzU1WiIgZmlsbD0iIzAwNEZCNiIvPg0KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNODIuOTE5MSAwTDc4LjI0ODYgMTEuMjE2M0w3My44MDI5IDBINjguMTQzMVYwLjQ4MjQ3QzY4Ljc5NjcgMC42MDg0OTYgNjkuNTMwMyAwLjg4OTcwMSA2OS44NjUxIDEuNzM2MTRMNzUuMjM4MSAxNS4yOTYxSDc5LjU2MjVMODUuOTMxNCAwSDgyLjkxOTFaIiBmaWxsPSIjMDA0RkI2Ii8+DQogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02MC4xOTMgMFYwLjQ4MjQ3QzYwLjUyNSAwLjU0MjY2MSA2MS43MTQ3IDAuODg5NzAxIDYxLjcxNDcgMS43MzYxNFYxNS4yOTYxSDY1Ljc0MjhWMEg2MC4xOTNaIiBmaWxsPSIjMDA0RkI2Ii8+DQogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01NC45OTc4IDBMNTAuMzI3MyAxMS4yMTYzTDQ1Ljg4MTcgMEg0MC4yMjE4VjAuNDgyNDdDNDAuODc2NCAwLjYwODQ5NiA0MS42MDkgMC44ODk3MDEgNDEuOTQ0OCAxLjczNjE0TDQ3LjMxNTkgMTUuMjk2MUg1MS42NDEyTDU4LjAxMjEgMEg1NC45OTc4WiIgZmlsbD0iIzAwNEZCNiIvPg0KICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjguNTE5NSAwVjAuNDgyNDdDMjkuMDA2NyAwLjU4NDk4MyAzMC4wNjQ3IDAuODgwMjk3IDI5LjYzNTggMS44MzQ4OUwyMy42Mjk5IDE1LjI5NjFIMjYuODAzMUwyOC42ODQxIDExLjA5OTZIMzUuMzM4TDM2Ljk4MjkgMTUuMjk2MUg0MS4xNTU5TDM1LjE5NTEgMEgyOC41MTk1Wk0zMi4yMzQzIDMuMTgyNjFMMzQuNTkzMSA5LjE5OTg1SDI5LjUzNjFMMzIuMjM0MyAzLjE4MjYxWiIgZmlsbD0iIzAwNEZCNiIvPg0KPC9zdmc+DQo=t src="assets/jquery-3.3.1.min.js"></script>

</head>
<body>
<div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
    <header class="masthead mb-auto">
        <div class="inner">
            <h3 class="masthead-brand">Aviva Zero Tech Test</h3>
        </div>
    </header>

    <main role="main" class="inner cover">
        <h1 class="cover-heading">Food Agency Data Summarizer.</h1>
        <p class="lead">This summarizer will take take all the data from a specific authority, and show you how the food
            hygiene ratings are distributed.</p>
        <p><label> Select an Authority:
            <select class="js-authority-select">
                <!-- auto filled in -->
            </select>
        </label></p>
        <table class="table table-dark table-striped">
            <thead>
            <tr>
                <th>Rating</th>
                <th>Percentage</th>
            </tr>
            </thead>
            <tbody class="js-authority-table">
                <!-- auto filled in -->
            </tbody>
        </table>

    </main>

    <footer class="mastfoot mt-auto">
        <div class="inner">
            <p><a href="http://www.zero.aviva.co.uk">Aviva Zero</a> - Full Stack Tech Test. <a
                    href="http://www.zero.aviva.co.uk" class="btn btn-secondary">Find out
                more?</a></p>
        </div>
    </footer>
</div>

<script>
    $(function () {

        $('.js-authority-select').on('change', function () {
            loadAuthority(this.value);
        });

        $.get('/api', {}, function (resp) {
            var selectElem = $('.js-authority-select');
            selectElem.html('');
            $.each(resp, function (key, authority) {
                if(key === 0){
                    loadAuthority(authority.id);
                }
                selectElem.append('<option value="' + authority.id + '">' + authority.name + '</option>');
            });

        });


    });

    function loadAuthority(id) {
        $.get('/api/' + id, {}, function (resp) {
            var tableElem = $('.js-authority-table');
            tableElem.html('');
            $.each(resp, function (key, rating) {
                tableElem.append('<tr><td>' + rating.name + '</td><td>' + rating.value.toFixed(1) + '%</td></tr>');
            });
        });
    }
</script>

</body>
</html>

